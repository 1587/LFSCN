<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      8.2.&nbsp;创建 /etc/fstab 文件
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="lfs" id="lfs-SVN-20130226">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 SVN-20130226
      </h4>
      <h3>
        第&nbsp;8&nbsp;章&nbsp;使 LFS 系统可以引导
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="introduction.html" title="介绍">上一页</a>
          <p>
            介绍
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="kernel.html" title="Linux-3.8">下一页</a>
          <p>
            Linux-3.8
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter08.html" title=
          "第&nbsp;8&nbsp;章&nbsp;使 LFS 系统可以引导">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 SVN-20130226">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-bootable-fstab" name="ch-bootable-fstab"></a>8.2. 创建
        /etc/fstab 文件
      </h1>
      <p>
        <code class="filename">/etc/fstab</code>
        文件被某些程序决定默认的文件系统挂载点。在挂载文件系统的时候会被优先检查，以防整合错误。像这样创建这个文件：
      </p>
      <pre class="userinput">
<kbd class="command">cat &gt; /etc/fstab &lt;&lt; "EOF"
<code class="literal"># Begin /etc/fstab

# file system  mount-point  type     options             dump  fsck
#                                                              order

/dev/<em class=
"replaceable"><code>&lt;xxx&gt;</code></em>     /            <em class=
"replaceable"><code>&lt;fff&gt;</code></em>    defaults            1     1
/dev/<em class=
"replaceable"><code>&lt;yyy&gt;</code></em>     swap         swap     pri=1               0     0
proc           /proc        proc     nosuid,noexec,nodev 0     0
sysfs          /sys         sysfs    nosuid,noexec,nodev 0     0
devpts         /dev/pts     devpts   gid=4,mode=620      0     0
tmpfs          /run         tmpfs    defaults            0     0
devtmpfs       /dev         devtmpfs mode=0755,nosuid    0     0

# End /etc/fstab</code>
EOF</kbd>
</pre>
      <p>
        将 <em class="replaceable"><code>&lt;xxx&gt;</code></em>、<em class=
        "replaceable"><code>&lt;yyy&gt;</code></em> 和 <em class=
        "replaceable"><code>&lt;fff&gt;</code></em> 替换成合适的值，例如 <code class=
        "filename">hda2</code>、<code class="filename">hda5</code> 和
        <code class="systemitem">ext3</code>。关于这六个域的细节，可通过 <span class=
        "command"><strong>man 5 fstab</strong></span>查看。
      </p>
      <p>
        源自 MS-DOS 或者 Windows 的文件系统 (例如：vfat、ntfs、smbfs、cifs、iso9660、udf)
        需要使用挂载选项 “<span class="quote">iocharset</span>” 使得文件名中的非 ASCII
        字符能够正确转码。此选项的值应该与你的区域数据的字符集相同，内核才能够理解。如果对应的字符集定义 (位于 File systems
        -&gt; Native Language Support，即文件系统 -&gt; 原生语言支持)
        编译到内核中或者编译成一个模块，它就能正常工作。vfat 和 smbfs 文件系统还需要 “<span class=
        "quote">codepage</span>” 这个选项。它应该设置为你所在的国家在 MS-DOS 下使用的编码页号码。例如，为了挂载
        USB 闪存驱动器，zh_CN.GB2312 用户的 <code class="filename">/etc/fstab</code>
        文件中会需要：
      </p>
      <pre class="screen">
<code class=
"literal">noauto,user,quiet,showexec,iocharset=gb2312,codepage=936</code>
</pre>
      <p>
        对应的 zh_CN.UTF-8 用户会需要：
      </p>
      <pre class="screen">
<code class=
"literal">noauto,user,quiet,showexec,iocharset=utf8,codepage=936</code>
</pre>
      <div class="admon note">
        <img alt="[注意]" src="../images/note.png" />
        <h3>
          注意
        </h3>
        <p>
          后面一种情况中，内核会产生以下消息：
        </p>
        <pre class="screen">
<code class=
"computeroutput">FAT: utf8 is not a recommended IO charset for FAT filesystems, filesystem will be case sensitive! </code>
</pre>
        <p>
          这个消极的推荐可以忽略，因为其他所有的 “<span class="quote">iocharset</span>” 选项都会导致
          UTF-8 区域数据中文件名显示不正确。
        </p>
      </div>
      <p>
        还可以在内核配置的过程中为某些文件系统指定默认的编码页和 iocharset 值。对应的参数名为 “<span class=
        "quote">Default NLS Option</span>” (<code class=
        "option">CONFIG_NLS_DEFAULT</code>，默认 NLS 选项)、“<span class=
        "quote">Default Remote NLS Option</span>” (<code class=
        "option">CONFIG_SMB_NLS_DEFAULT</code>，默认远程 NLS 选项) “<span class=
        "quote">Default codepage for FAT</span>” (<code class=
        "option">CONFIG_FAT_DEFAULT_CODEPAGE</code>，FAT 默认编码页) 和
        “<span class="quote">Default iocharset for FAT</span>” (<code class=
        "option">CONFIG_FAT_DEFAULT_IOCHARSET</code>，FAT 默认
        iocharset)。在内核编译期间无法为 ntfs 文件系统指定这些设置。
      </p>
      <p>
        在某些硬盘上可以使 ext3 文件系统在突然断电时依然可靠。若要如此，给 <code class=
        "filename">/etc/fstab</code> 中对应的条目添加 <code class=
        "option">barrier=1</code> 挂载选项。要检查磁盘驱动器是否支持此选项，给对应的磁盘驱动器运行 <a class=
        "ulink" href=
        "http://www.linuxfromscratch.org/blfs/view/cvs/general/hdparm.html">hdparm</a>。例如，如果：
      </p>
      <pre class="userinput">
<kbd class="command">hdparm -I /dev/sda | grep NCQ</kbd>
</pre>
      <p>
        返回非空的值表示支持这一选项。
      </p>
      <p>
        注意：基于逻辑卷管理 (LVM) 的分区不能使用 <code class="option">barrier</code> 选项。
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="introduction.html" title="介绍">上一页</a>
          <p>
            介绍
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="kernel.html" title="Linux-3.8">下一页</a>
          <p>
            Linux-3.8
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter08.html" title=
          "第&nbsp;8&nbsp;章&nbsp;使 LFS 系统可以引导">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 SVN-20130226">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
