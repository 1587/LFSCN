<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      7.10.&nbsp;配置Linux控制台
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="lfs" id="lfs-SVN-20120405">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 SVN-20120405
      </h4>
      <h3>
        第&nbsp;7&nbsp;章&nbsp;设置系统启动脚本
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="setclock.html" title="配置setclock脚本">上一页</a>
          <p>
            配置setclock脚本
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="sysklogd.html" title=
          "Configuring the sysklogd Script">下一页</a>
          <p>
            Configuring the sysklogd Script
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter07.html" title=
          "第&nbsp;7&nbsp;章&nbsp;设置系统启动脚本">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 SVN-20120405">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-scripts-console" name="ch-scripts-console"></a>7.10.
        配置Linux控制台
      </h1>
      <p>
        这一章节谈论如何设置 <span class="command"><strong>console</strong></span>
        启动脚本。包括正确配置键盘表，控制台字体，系统启动级别。如果不使用非ASCII字符且键盘是标准US键盘的话，本章节的大部分内容可以跳过。没有相应的配置文件的话，（或者
        <code class="filename">rc.site</code> 文件中等价的设置），<span class=
        "command"><strong>console</strong></span> 启动脚本不会做任何事情。
      </p>
      <p>
        <span class="command"><strong>console</strong></span> 脚本读取
        <code class="filename">/etc/sysconfig/console</code>
        文件来获取相关的配置信息，决定使用哪个键盘映射表和屏幕字体。关于如何让控制台支持其他语言可以在下面的地址找着答案 <a class=
        "ulink" href=
        "http://www.tldp.org/HOWTO/HOWTO-INDEX/other-lang.html">http://www.tldp.org/HOWTO/HOWTO-INDEX/other-lang.html</a>。如果还有疑问，可以查看
        <code class="filename">/lib/kbd</code> 文件夹的内容来获取合法的键盘映射表和屏幕字体。还可以查看
        <code class="filename">loadkeys(1)</code> 和 <code class=
        "filename">setfont(8)</code> 来确定如何使用正确的参数运行这些程序。
      </p>
      <p>
        <code class="filename">/etc/sysconfig/console</code>
        应该包含如下形式的行：变量="值"。下面是合法的变量：
      </p>
      <div class="variablelist">
        <dl>
          <dt>
            <span class="term">LOGLEVEL</span>
          </dt>
          <dd>
            <p>
              这个变量可以像 <span class="command"><strong>dmesg</strong></span>
              命令一样定义内核消息级别（内核会把根据这个级别确定的一类内核信息发送到控制台）。从"1"（没有消息）到"8"都是合法的等级。默认的等级是"7"。
            </p>
          </dd>
          <dt>
            <span class="term">KEYMAP</span>
          </dt>
          <dd>
            <p>
              这个变量定义了 <span class="command"><strong>loadkeys</strong></span>
              程序的参数，通常是你的键盘映射表的名字，例如，“<span class=
              "quote">es</span>”。如果这个变量没有设置，启动脚本不会运行 <span class=
              "command"><strong>loadkeys</strong></span> 程序，默认的键盘映射表会启用。
            </p>
          </dd>
          <dt>
            <span class="term">KEYMAP_CORRECTIONS</span>
          </dt>
          <dd>
            <p>
              这个（很少用到的）变量指定第二次调用 <span class=
              "command"><strong>loadkeys</strong></span>
              程序时传递给它的参数。这在标准键盘表并不完全匹配你的键盘，需要做小幅调整时非常有用。例如，为了加入Euro标志到一个通常并不包含它的键盘映射表中，可以将这个变量设置成“<span class="quote">euro2</span>”。
            </p>
          </dd>
          <dt>
            <span class="term">FONT</span>
          </dt>
          <dd>
            <p>
              这个变量指定调用 <span class="command"><strong>setfont</strong></span>
              程序的参数。通常包括字体名称，“<span class=
              "quote">-m</span>”，需要加载的被应用程序使用的字符集（application character
              map）。例如,为了加载“<span class=
              "quote">lat1-16</span>”字体和“<span class="quote">8859-1</span>”字符集（美国中较为常用），设置这个变量为“<span class="quote">lat1-16
              -m 8859-1</span>”。 In UTF-8 mode, the kernel uses the
              application character map for conversion of composed 8-bit key
              codes in the keymap to UTF-8, and thus the argument of the "-m"
              parameter should be set to the encoding of the composed key
              codes in the keymap.
            </p>
          </dd>
          <dt>
            <span class="term">UNICODE</span>
          </dt>
          <dd>
            <p>
              将这个变量设置为“<span class="quote">1</span>”，“<span class=
              "quote">yes</span>”或“<span class=
              "quote">true</span>”可以让控制台运行在UTF-8模式。这对基于UTF-8的 locale
              很有用，但是对其他的有害。
            </p>
          </dd>
          <dt>
            <span class="term">LEGACY_CHARSET</span>
          </dt>
          <dd>
            <p>
              For many keyboard layouts, there is no stock Unicode keymap in
              the Kbd package. The <span class=
              "command"><strong>console</strong></span> bootscript will
              convert an available keymap to UTF-8 on the fly if this
              variable is set to the encoding of the available non-UTF-8
              keymap.
            </p>
          </dd>
        </dl>
      </div>
      <p>
        Some examples:
      </p>
      <div class="itemizedlist">
        <ul>
          <li>
            <p>
              For a non-Unicode setup, only the KEYMAP and FONT variables are
              generally needed. E.g., for a Polish setup, one would use:
            </p>
            <pre class="userinput">
<kbd class="command">cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<code class="literal"># Begin /etc/sysconfig/console

KEYMAP="pl2"
FONT="lat2a-16 -m 8859-2"

# End /etc/sysconfig/console</code>
EOF</kbd>
</pre>
          </li>
          <li>
            <p>
              As mentioned above, it is sometimes necessary to adjust a stock
              keymap slightly. The following example adds the Euro symbol to
              the German keymap:
            </p>
            <pre class="userinput">
<kbd class="command">cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<code class="literal"># Begin /etc/sysconfig/console

KEYMAP="de-latin1"
KEYMAP_CORRECTIONS="euro2"
FONT="lat0-16 -m 8859-15"

# End /etc/sysconfig/console</code>
EOF</kbd>
</pre>
          </li>
          <li>
            <p>
              The following is a Unicode-enabled example for Bulgarian, where
              a stock UTF-8 keymap exists:
            </p>
            <pre class="userinput">
<kbd class="command">cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<code class="literal"># Begin /etc/sysconfig/console

UNICODE="1"
KEYMAP="bg_bds-utf8"
FONT="LatArCyrHeb-16"

# End /etc/sysconfig/console</code>
EOF</kbd>
</pre>
          </li>
          <li>
            <p>
              Due to the use of a 512-glyph LatArCyrHeb-16 font in the
              previous example, bright colors are no longer available on the
              Linux console unless a framebuffer is used. If one wants to
              have bright colors without framebuffer and can live without
              characters not belonging to his language, it is still possible
              to use a language-specific 256-glyph font, as illustrated
              below:
            </p>
            <pre class="userinput">
<kbd class="command">cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<code class="literal"># Begin /etc/sysconfig/console

UNICODE="1"
KEYMAP="bg_bds-utf8"
FONT="cyr-sun16"

# End /etc/sysconfig/console</code>
EOF</kbd>
</pre>
          </li>
          <li>
            <p>
              The following example illustrates keymap autoconversion from
              ISO-8859-15 to UTF-8 and enabling dead keys in Unicode mode:
            </p>
            <pre class="userinput">
<kbd class="command">cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<code class="literal"># Begin /etc/sysconfig/console

UNICODE="1"
KEYMAP="de-latin1"
KEYMAP_CORRECTIONS="euro2"
LEGACY_CHARSET="iso-8859-15"
FONT="LatArCyrHeb-16 -m 8859-15"

# End /etc/sysconfig/console</code>
EOF</kbd>
</pre>
          </li>
          <li>
            <p>
              Some keymaps have dead keys (i.e., keys that don't produce a
              character by themselves, but put an accent on the character
              produced by the next key) or define composition rules (such as:
              “<span class="quote">press Ctrl+. A E to get Æ</span>” in the
              default keymap). Linux-3.3.1 interprets dead keys and
              composition rules in the keymap correctly only when the source
              characters to be composed together are not multibyte. This
              deficiency doesn't affect keymaps for European languages,
              because there accents are added to unaccented ASCII characters,
              or two ASCII characters are composed together. However, in
              UTF-8 mode it is a problem, e.g., for the Greek language, where
              one sometimes needs to put an accent on the letter
              “<span class="quote">alpha</span>”. The solution is either to
              avoid the use of UTF-8, or to install the X window system that
              doesn't have this limitation in its input handling.
            </p>
          </li>
          <li>
            <p>
              对于中文，日文，棒子文及一些其他的语言的用户，Linux的控制台无法通过简单配置显示他们需要的字体。需要这些语言的用户需要安装
              X Window 系统，包含这些语言的字符的字体，黑又合适的输入法（例如，SCIM，它支持很多种语言）。
            </p>
          </li>
        </ul>
      </div>
      <div class="admon note">
        <img alt="[注意]" src="../images/note.png" />
        <h3>
          注意
        </h3>
        <p>
          The <code class="filename">/etc/sysconfig/console</code> file only
          controls the Linux text console localization. It has nothing to do
          with setting the proper keyboard layout and terminal fonts in the X
          Window System, with ssh sessions or with a serial console. In such
          situations, limitations mentioned in the last two list items above
          do not apply.
        </p>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="setclock.html" title="配置setclock脚本">上一页</a>
          <p>
            配置setclock脚本
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="sysklogd.html" title=
          "Configuring the sysklogd Script">下一页</a>
          <p>
            Configuring the sysklogd Script
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter07.html" title=
          "第&nbsp;7&nbsp;章&nbsp;设置系统启动脚本">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 SVN-20120405">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
