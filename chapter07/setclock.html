<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      7.9.&nbsp;配置 setclock 脚本
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="lfs" id="lfs-SVN-20121118">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 SVN-20121118
      </h4>
      <h3>
        第&nbsp;7&nbsp;章&nbsp;设置系统引导脚本
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="hostname.html" title="配置系统主机名">上一页</a>
          <p>
            配置系统主机名
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="console.html" title="配置 Linux 控制台">下一页</a>
          <p>
            配置 Linux 控制台
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter07.html" title=
          "第&nbsp;7&nbsp;章&nbsp;设置系统引导脚本">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 SVN-20121118">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-scripts-setclock" name="ch-scripts-setclock"></a>7.9. 配置
        setclock 脚本
      </h1>
      <p>
        <span class="command"><strong>setclock</strong></span> 脚本从硬件时钟 (又称
        BIOS 或 CMOS) 读取时间。如果硬件时钟设置为 UTC，此脚本会将其转换为 <code class=
        "filename">/etc/localtime</code> 文件 (告知 <span class=
        "command"><strong>hwclock</strong></span> 程序用户所在的时区)
        中时区的时间。无法探测硬件时钟是否设置为 UTC，所以此项应收工配置。
      </p>
      <p>
        <span class="command"><strong>setclock</strong></span>
        在引导时内核检测到硬件支持时通过 <span class="application">udev</span>
        运行。还可以手工不带参数运行麻将系统时间写入 CMOS 时钟。
      </p>
      <p>
        如果你无法记住硬件时钟是否设置为 UTC，运行 <strong class="userinput"><code>hwclock
        --localtime --show</code></strong>
        命令。它会显示你硬件时钟的当前时间。如果这个时间和你手表上的时间相同，那就表示硬件时钟设置为本地时间。如果其输出不是本地时间，它有可能是一定可能设置为
        UTC。将 <span class="command"><strong>hwclock</strong></span>
        输出的时间加减正确的小时数。例如，位于中国大陆的 GMT +0800 时区的用户应该将 <span class=
        "command"><strong>hwclock</strong></span> 的输出减去 8 小时。
      </p>
      <p>
        如果你的硬件时钟<span class="emphasis"><em>未</em></span>设置为 UTC 时间，将以下
        <code class="envar">UTC</code> 变量的值改为 <em class=
        "parameter"><code>0</code></em> (数字零)。
      </p>
      <p>
        运行以下命令创建一个新文件 <code class="filename">/etc/sysconfig/clock</code>：
      </p>
      <pre class="userinput">
<kbd class="command">cat &gt; /etc/sysconfig/clock &lt;&lt; "EOF"
<code class="literal"># Begin /etc/sysconfig/clock

UTC=1

# Set this to any options you might need to give to hwclock, 
# such as machine hardware clock type for Alphas.
CLOCKPARAMS=

# End /etc/sysconfig/clock</code>
EOF</kbd>
</pre>
      <p>
        <a class="ulink" href=
        "http://www.linuxfromscratch.org/hints/downloads/files/time.txt">此处</a>有一个有关
        LFS 系统上事件处理的提示。它解释了时区、UTC 和 <code class="envar">TZ</code> 环境变量的相关信息
      </p>
      <div class="admon note">
        <img alt="[注意]" src="../images/note.png" />
        <h3>
          注意
        </h3>
        <p>
          CLOCKPARAMS 和 UTC 参数也可以在 <code class=
          "filename">/etc/sysconfig/rc.site</code> 文件中设置。
        </p>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="hostname.html" title="配置系统主机名">上一页</a>
          <p>
            配置系统主机名
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="console.html" title="配置 Linux 控制台">下一页</a>
          <p>
            配置 Linux 控制台
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter07.html" title=
          "第&nbsp;7&nbsp;章&nbsp;设置系统引导脚本">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 SVN-20121118">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
